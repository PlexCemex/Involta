Реализуйте сервис notification-processor, который читает события пользовательских действий из Kafka, формирует персонализированные уведомления и гарантирует их доставку через внешний сервис.

Пример сообщения Kafka:

{
  "event_id": "uuid",
  "user_id": 12345,
  "event_type": "order_created|payment_received|order_shipped", // будет 1 из 3-х кодов
  "timestamp": "RFC3339",
  "payload": { /* произвольный JSON */ }
}


Сервис должен отправлять уведомления по правилам:
order_created → email + push
payment_received → email
order_shipped → push + sms

По понятным причинам делать саму отправку не надо, достаточно вывести лог, в котором будет указано кому было отправлено сообщение и по какому каналу 

Так же реализовать функцию эмуляции сбоя доставки таким образом, что 10% вызовов возвращают временные ошибки (повторить через экспоненциальную задержку), 1% вызовов возвращают перманентные ошибки (прекратить попытки после 3-й)

Обязательные гарантии для сервиса(ов):
Идемпотентность — повторное сообщение с тем же event_id не создаёт дубликат уведомления.
Exactly-once семантика — сообщение не теряется при падении сервиса между записью в БД и коммитом оффсета.
Устойчивость к сбоям — poison pill (битый JSON) не останавливает обработку других сообщений.
Без утечек — сервис работает часами без роста памяти при постоянных временных ошибках доставки.
Graceful shutdown — обработка текущих сообщений завершается корректно по SIGTERM.

Требования к реализации:
- Используйте PostgreSQL для хранения состояния уведомлений и дедупликации.
- Используйте Kafka (любая популярная библиотека на Go) с ручным управлением оффсетами (автокоммит запрещён).
- Обеспечьте конкурентную обработку сообщений без дедлоков.
- Реализуйте повторные попытки доставки (макс. 3) с экспоненциальной задержкой.
- Код должен компилироваться и запускаться через go run.

Подготовить тестовые даные для демонстрации работоспособности кода. 
